#------------------------------------------------------------------------------
# Author: Kalyan S. Perumalla
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
LIBSYNK = libsynk.a
LIBOBJS = fm.o fmshm.o fmgm.o fmtcp.o fmmpi.o rm.o rmbar.o tm.o tmred.o tmnull.o mycompat.o
TESTS   = gmtest fmtest rmtest

#------------------------------------------------------------------------------
CC = mpicc
CFLAGS  = -g -O3 -I. -DMPI_AVAILABLE=1 -DNODEBUG=0
LDFLAGS = $(LIBSYNK)
LDLIBS  = $(LDFLAGS)

#------------------------------------------------------------------------------
.c:
	@ echo Making $< to $@
	$(CC) -o $@.o $(CFLAGS) -c $<
	$(CC) -o $@ $@.o $(LDLIBS)

#------------------------------------------------------------------------------
all: $(LIBSYNK) $(TESTS)

#------------------------------------------------------------------------------
$(LIBSYNK): $(LIBOBJS)
	$(AR) cr $(LIBSYNK) $(LIBOBJS)
	ranlib $(LIBSYNK)

#------------------------------------------------------------------------------
clean:
	rm -f $(LIBOBJS) $(LIBSYNK) $(TESTS)
	rm -f *.o *.a

#------------------------------------------------------------------------------
